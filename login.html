<!-- login.html -->
<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>შესვლა • Zaratic Role Play</title>
    <link rel="icon" href="https://raw.githubusercontent.com/OGSunny/Testerweb/main/lv_0_20251120194047.jpg">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <style>
        :root{--bg:#0a0a10;--card:rgba(25,25,45,.97);--accent:#e91e63;--glow:rgba(233,30,99,.25);--border:rgba(233,30,99,.3);--text:#fff;--muted:#bbb}
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Noto Sans Georgian',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:grid;place-items:center}
        .glow{position:fixed;width:800px;height:800px;background:radial-gradient(circle,var(--glow),transparent 70%);filter:blur(140px);top:50%;left:50%;transform:translate(-50%,-50%)}
        .box{background:var(--card);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:20px;padding:45px 40px;width:400px;box-shadow:0 20px 60px rgba(0,0,0,.8)}
        .logo{width:110px;height:110px;border-radius:50%;margin:0 auto 25px;border:4px solid var(--accent);box-shadow:0 0 40px var(--glow)}
        h1{text-align:center;font-size:32px;margin-bottom:30px;color:var(--accent)}
        input{width:100%;padding:16px 20px;margin:12px 0;background:rgba(255,255,255,.05);border:1px solid var(--border);border-radius:12px;color:#fff;font-size:15px;transition:.3s}
        input:focus{outline:none;border-color:var(--accent);box-shadow:0 0 20px var(--glow)}
        button{width:100%;padding:16px;background:var(--accent);border:none;border-radius:12px;color:#fff;font-weight:600;font-size:16px;cursor:pointer;margin-top:20px;transition:.3s}
        button:hover{background:#ff4081;transform:translateY(-2px)}
        button:disabled{opacity:.6;cursor:not-allowed}
        .switch{text-align:center;margin-top:25px;font-size:14px}
        .switch a{color:var(--accent);cursor:pointer;font-weight:600}
        .error{color:#ff5252;text-align:center;margin-top:15px;padding:10px;background:rgba(255,82,82,.1);border-radius:8px;font-size:14px}
        .remember{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:13px;margin:10px 0}
    </style>
</head>
<body>
    <div class="glow"></div>
    <div class="box">
        <img src="https://raw.githubusercontent.com/OGSunny/Testerweb/main/lv_0_20251120194047.jpg" class="logo">
        <h1 id="title">შესვლა</h1>
        <form id="form">
            <input type="text" id="username" placeholder="მომხმარებელი" required minlength="3">
            <input type="password" id="password" placeholder="პაროლი" required minlength="4">
            <label class="remember"><input type="checkbox"> დამახსოვრება</label>
            <button type="submit" id="btn">შესვლა</button>
        </form>
        <div class="switch">არ გაქვს ანგარიში? <a id="toggle">რეგისტრაცია</a></div>
        <div class="error" id="error"></div>
    </div>

    <script>
        const worker = 'https://data.jemalagegidze.workers.dev';
        let isLogin = true;
        if(localStorage.getItem('username')) location.href='forum.html';

        document.getElementById('toggle').onclick=()=>{
            isLogin=!isLogin;
            document.getElementById('title').textContent=isLogin?'შესვლა':'რეგისტრაცია';
            document.getElementById('btn').textContent=isLogin?'შესვლა':'რეგისტრაცია';
            document.querySelector('.switch').innerHTML=isLogin?'არ გაქვს ანგარიში? <a id="toggle">რეგისტრაცია</a>':'უკვე გაქვს? <a id="toggle">შესვლა</a>';
            document.getElementById('error').textContent='';
        };

        document.getElementById('form').onsubmit=async e=>{
            e.preventDefault();
            const u=document.getElementById('username').value.trim();
            const p=document.getElementById('password').value;
            const btn=document.getElementById('btn');
            btn.disabled=true; btn.innerHTML='<i class="fas fa-spinner fa-spin"></i> მიმდინარეობს...';
            try{
                const res=await fetch(worker+(isLogin?'/login':'/register'),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});
                const data=await res.json();
                if(!res.ok) throw new Error(data.error||'შეცდომა');
                localStorage.setItem('username',u);
                location.href='forum.html';
            }catch(err){
                document.getElementById('error').textContent=err.message;
            }finally{
                btn.disabled=false; btn.textContent=isLogin?'შესვლა':'რეგისტრაცია';
            }
        };
    </script>
</body>
</html>
